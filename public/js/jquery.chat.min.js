/*! jchat 2014-07-16 */
!function(a){a.fn.chat=function(c){return plug=a.fn.chat,o=a.extend({},plug.defaults,c),this.each(function(){var c=new b;a("#colorChooser span").click(function(){a(".colors").toggle("slow")}),a(".colorbox").click(function(){c.colorChooser(this)}),a(this).find("#chatForm").on("submit",function(a){c.submitMsg(this,a)})})};var b=function(){this.socket=io(),this.user=null,this.color="blue",this.initUser(),this.initChat()};b.prototype={submitMsg:function(b,c){return c.preventDefault(),this.socket.emit("chat message",{time:new Date,user:this.user,msg:a("#m").val(),color:this.color}),a("#m").val(""),!1},initChat:function(){this.socket.on("chat message",function(b){a("#messages").append(a("<li></li>").append(a("<span>").text(b.time),a("<b>").text("undefined"!=typeof b.user?b.user+": ":""),a("<span>").attr("style","color:"+b.color).html(b.msg))),a("html, body").scrollTop(a(document).height()-a(window).height(),"slow")})},initUser:function(){null===this.user&&(a("#user-wrapper").show(),a("#userForm").on("submit",a.proxy(function(b){return b.preventDefault(),""===a("#name").val()?(a(".error").show(),!1):(this.user=a("#name").val(),a("#user-wrapper").hide(),void this.socket.emit("connected",{user:this.user}))},this)))},colorChooser:function(b){this.color=a(b).css("background-color"),a("#m").css("color",this.color);var c=a(b).width(),d=a(b).height();a(b).animate({width:c+2,height:d+2},{duration:200}).animate({width:c,height:d},200)}},a.fn.chat.defaults={io:null}}(jQuery);